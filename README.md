# web-voftv-lab1

Навчальний проєкт з дисципліни **Web-програмування** (ЛНТУ).  
Це міні-гра за мотивами *Voices of the Void*: веб-термінал віддаленої обсерваторії, де гравець сканує небо, знаходить сигнали та зберігає їх у базу.

Репозиторій використовується як основа для виконання лабораторних робіт 1–4:
- Лаба 1–2 — простий веб-інтерфейс + бекенд на Node.js/Express + SQLite.
- Лаба 3 — Domain-Driven Design, шарова архітектура (domain / application / infrastructure).
- Лаба 4 — проєктування API (OpenAPI), CRUD для сигналів, health-check.

---

## Ігровий процес (Coordinates panel)

Поки що реалізовано **перший термінал** — панель координат (Coordinates panel).

Основні можливості:

- **Глобальна мапа неба**  
  - Випадково згенероване зоряне небо на великій 2D-карті.  
  - На трекпаді видно лише вікно (viewport), яке можна рухати стрілками або WASD.
  - Координати перетворюються в азимут `az` (0–359°) та кут піднесення `el` (0–90°).

- **Пошук маячків (PING)**  
  - Кнопка `PING` генерує нові маячки на глобальній карті.  
  - На краях трекпада з’являються **направляючі** (червоні кола), які вказують напрямок до маячка.  
  - PING має **15-секундний cooldown** з прогрес-баром у стилі VoTV.

- **Захоплення та сканування сигналу (SCAN)**  
  - Коли хрестик у центрі трекпада наводиться на маячок, ціль вважається захопленою, кнопка `SCAN` стає активною.  
  - Після захоплення рух трекпада блокується до завершення сканування.  
  - SCAN запускає таймер обробки з ASCII-прогрес-баром у вертикальному логові.  
  - При успіху створюється новий запис сигналу в БД (через бекенд-ендпоінт `/signal`), при фейлі виводиться повідомлення про слабкий або втрачений сигнал.

- **Вертикальний лог (scan log)**  
  - Для кожного PING/SCAN створюється окрема рамка:

    ```text
    ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
    ┃ 2025-11-22 21:37:12             ┃
    ┃ SCAN [##########________]  50%  ┃
    ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
    ```

  - Зберігається кілька останніх рамок; старі витісняються вгору.

- **Горизонтальний лог подій (game log)**  
  - Текстові повідомлення про дії гравця:
    - `PING sent. Beacons updated.`
    - `Target locked. Ready to SCAN.`
    - `Scan complete. Signal stored.` тощо.

- **Recent / History**  
  - Блок `Recent` показує останні отримані сигнали (через `/signal`).  
  - Розділ `History` завантажує повну історію з `/signals` і дозволяє зробити `Reset` БД через `/admin/reset`.

---

## Архітектура

Проєкт реалізовано як **модульний моноліт** на Node.js з чіткими шарами:

- `server/src/domain/`  
  - Домени (сутність `Signal`, інтерфейси репозиторіїв).

- `server/src/application/`  
  - Сценарії використання (use cases), які працюють з доменом:  
    створення сигналу, отримання списку, оновлення, видалення тощо.

- `server/src/infrastructure/`  
  - Адаптери до БД (SQLite) та HTTP:
    - `db/SignalRepoSqlite.js`
    - `http/signals.routes.js`
    - `http/admin.routes.js`
  - Тут налаштовано Express-сервер.

- `client/`  
  - Статичний веб-клієнт (HTML + JS), який звертається до HTTP-API:
    - `/signal` — ігровий ендпоінт для Coordinates panel;
    - `/signals` — історія сигналів;
    - `/health` — health-check.

Деталі рішень зафіксовано в ADR:

- `docs/adr/0001-architecture-style.md` — вибір модульного моноліту.  
- `docs/adr/0002-layered-architecture.md` — шари domain / application / infrastructure / client.  
- `docs/adr/0003-signal-crud-api.md` — CRUD-API для сутності `Signal`.

---

## API

Специфікація API описана у форматі **OpenAPI 3.0.3**:

- Файл: `docs/api/openapi.yaml`
- Основний ресурс: `Signal`

Передбачені ендпоінти:

- `GET /health` — перевірка стану сервісу.  
- `GET /signals` — отримати список сигналів (`limit` як опційний параметр).  
- `POST /signals` — створити новий сигнал.  
- `GET /signals/{id}` — отримати сигнал за `id`.  
- `PATCH /signals/{id}` — часткове оновлення сигналу.  
- `DELETE /signals/{id}` — видалити сигнал.  

Ігровий ендпоінт Coordinates panel:

- `GET /signal?az=<0..359>&el=<0..90>` — згенерувати та зберегти сигнал для заданих координат.

### Swagger Editor

Для верифікації використано [Swagger Editor](https://editor.swagger.io/).  
Скріншот з редактора (усі ендпоінти успішно відрендерились):

```text
docs/api/swagger-editor.png
